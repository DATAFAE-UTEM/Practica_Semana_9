#!/usr/bin/python
# -*- coding: UTF-8 -*-

import re
import pandas as pd
from nltk.stem import WordNetLemmatizer
from nltk.tokenize import RegexpTokenizer
from nltk.corpus import stopwords
from sklearn.feature_extraction.text import TfidfVectorizer

# Cargar documentos
df = pd.read_csv('text.csv', sep=";")

# Cargamos la data a modelar
text_1 = "REF. EJECUTA ACUERDO DEL CONSEJO DE LA  COMISION PARA EL MERCADO  FINANCIERO QUE APRUEBA OFICIO  CIRCULAR QUE IMPARTE  INSTRUCCIONES A LAS COMPANIAS DE  SEGUROS DE VIDA QUE MANTIENEN  RESERVAS TECNICAS DE RENTAS  VITALICIAS, RESPECTO A LA  APLICACION DE LA LEY N° 21.330.  SANTIAGO, 30 de abril de 2021  RESOLUCION EXENTA N° 2340  VISTOS: Lo dispuesto en el articulo 3° de la Ley N° 19.880; en los articulos 5 N° 1, 20 N° 1 y 21 N°l del Decreto Ley N° 3.538 de 1980; en la Ley N° 21.330; en los articulos 1 y 17 de la Normativa Interna de Funcionamiento del Consejo de la Comisi6n para el Mercado Financiero, contenida en la Resolucién Exenta N° 1857 de 2021; en el Decreto Supremo N° 437 del Ministerio de Hacienda del afio 2018; lo acordado por el Consejo de la Comision para el Mercado Financiero en Sesi6n Extraordinaria N° 102 de 30 de abril de 2021; y en la Resoluci6n N° 7 de 2019, de la Contraloria General de la Republica.  CONSIDERANDO:  1. Que, segun lo establecido en el N°1 del articulo 5 del Decreto Ley N°3.538, dentro de las atribuciones generales de esta Comisi6n se encuentra el dictar las normas para la aplicacion y cumplimiento de las leyes y reglamentos y, en general, dictar cualquier otra normativa que, de conformidad con la ley, le corresponda para la regulacion del mercado financiero. De igual modo, correspondera a la Comisi6n interpretar administrativamente las leyes, reglamentos y demas normas que rigen a las personas, entidades o actividades fiscalizadas, y podra fijar normas, impartir instrucciones y dictar 6rdenes para su aplicacion y cumplimiento.  2. Que, actualmente se han adoptado medidas por la autoridad por el brote mundial del virus denominado coronavirus 2019 0 Covid-19 que produce la enfermedad del sindrome respiratorio agudo grave, que a juicio de la Organizacion Mundial de Salud puede ser considerado como una pandemia, incluyendo la declaraci6n de Estado de Excepcion Constitucional de Catastrofe en  cinta - Para validar ir a http://www.svs.cl/institucional/validar/validar. php  ae FOLIO: RES-2340-21-21272-A  Bar ven a eh?  Chile.  3. Que, el 28 de abril de 2021, se public6é la Ley N°21.330 que modifica la Carta Fundamental, para establecer y regular un mecanismo excepcional de anticipo de parte de los fondos previsionales, disponiendo que “a partir de la publicacion en el Diario Oficial de esta reforma y hasta los 365 dias siguientes, los pensionados o sus beneficiarios por renta vitalicia podran, por una sola vez y de forma voluntaria, adelantar el pago de sus rentas vitalicias hasta por un monto equivalente al diez por ciento del valor correspondiente a la reserva técnica que mantenga el pensionado en la respectiva compania de seguros para cubrir el pago de sus pensiones, con un tope maximo de ciento cincuenta unidades de fomento”.  4. Que, en virtud de lo anterior, el Consejo de la Comisi6n para el Mercado Financiero, mediante acuerdo adoptado en Sesion Extraordinaria N° 102, de 30 de abril de 2021, acord6 la emisi6n de un Oficio Circular que imparte instrucciones a las compafiias de seguros de vida que mantienen reservas técnicas de rentas vitalicias, respecto a la aplicaci6n de la Ley N° 21.330.  5. Que, en lo pertinente, el articulo 17 de la Normativa Interna de Funcionamiento del Consejo de esta Comisi6n sefala que: “Dichos acuerdos podrdn llevarse a efecto aun cuando el acta en que deban constar no se encuentre suscrita por todos los comisionados presentes en la Sesion. Para estos efectos, se emitird por el Ministro de Fe un certificado del acuerdo, el cual se citard en la resoluci6n que lo formalice”’. En virtud de lo anterior, se emiti6 el certificado de 30 de abril de 2021 suscrito por el Ministro de Fe, donde consta el referido acuerdo.  6. Que, conforme lo dispuesto en el inciso séptimo del articulo 3° de la Ley N° 19.880 y en el N°1 del articulo 21 del referido Decreto Ley N°3.538, corresponde al Presidente de la Comision ejecutar y dar cumplimiento a los acuerdos adoptados por el Consejo de la Comisi6n para el Mercado Financiero.  RESUELVO:  Ejecutese el acuerdo del Consejo de la Comision para el Mercado Financiero, adoptado en Sesion Extraordinaria N°102, de 30 de abril de 2021, que aprueba la emisi6n de un Oficio Circular que imparte instrucciones a las compafiias de seguros de vida que mantienen reservas técnicas de rentas vitalicias, respecto a la aplicacion de la Ley N° 21.330.  GBR /LFA/JAG  Anotese, Comuniquese y Archivese. (/ JOAGUIN CORTEZ HUERTA . PRESIDENTE COMISION PARA EL WERCADO FINANCIERO  Eee a, | ae | ,  ara validar ir a http://www.svs.cl/institucional/validar/validar.php  ic kes FOLIO: RES-2340-21-21272-A  eee ae  Pagina 2/18  REF.: Imparte instrucciones a_ las companias de seguros de vida que mantienen reservas técnicas de rentas vitalicias. OFICIO CIRCULAR N°1208 30 de abril de 2021 Como es de su conocimiento, con fecha 28 de abril de 2021, se publico en el Diario Oficial, la Ley N°21.330, que modifica la Carta Fundamental para establecer y regular un mecanismo excepcional de anticipo del pago de rentas vitalicias, en adelante la “Ley”, que senala “a partir de la publicacion en el Diario Oficial de esta reforma y hasta los 365 dias siguientes, los pensionados o sus beneficiarios por renta vitalicia podrdn, por una sola vez y de forma voluntaria, adelantar el pago de sus rentas vitalicias hasta por un monto equivalente al diez por ciento del valor correspondiente ala reserva técnica que mantenga el pensionado en la respectiva compania de seguros para cubrir el pago de sus pensiones, con un tope maximo de ciento cincuenta unidades de fomento”. Ademas, senala la Ley, que “el pago de los fondos solicitados se efectuara al pensionado o sus beneficiarios en un plazo maximo de treinta dias corridos, contados desde la recepcion de la solicitud” y que “Los fondos retirados se considerardn extraordinariamente intangibles para todo efecto legal, y no seran objeto de retencion, descuento, compensacion legal o contractual, embargo o cualquier forma de afectacion judicial o administrativa, ni podra rebajarse del monto ya decretado de la compensacion economica en el juicio de divorcio, sin perjuicio del derecho de subrogacion legal del alimentario o su representante y de la retencion, suspension y embargabilidad por deudas originadas por obligaciones alimentarias de conformidad a lo previsto en la ley N° 21.254”. La solicitud de anticipo debera ser presentada por el pensionado ante la Compania de Seguro con la que tenga contratada la renta vitalicia, preferentemente por canales digitales, debiendo las Companias adoptar medidas para resguardar las condiciones sanitarias en el caso de solicitudes presenciales. La nueva Ley senala que les “serdn aplicables a las solicitudes de anticipos que efectuen los pensionados o sus beneficiarios por rentas vitalicias, las reglas relativas a la intangibilidad y naturaleza de estos recursos, la tramitacion de la solicitud, el pago de pensiones de alimentos Lelie el . ; Lo, ; ; Para validar ir a http://www.svs.cl/institucional/validar/validar.php 1 ie kes FOLIO: RES-2340-21-21272-A eee ae Pagina 3/18  impagas y la informacion a las autoridades correspondientes, incluida la Comision para el  Mercado Financiero, facultando a la Comision para el Mercado Financiero para dictar las  instrucciones necesarias para su aplicacion”.  Las siguientes instrucciones son de caracter minimo, lo que no obsta que las companias desarrollen  sistemas que permitan mejorar la interaccion con los asegurados, manteniendo estrictas medidas  de seguridad.  |. Implementacion del adelanto del pago de renta vitalicias  1. Difusion y servicio  Mediante sus diferentes canales de atenciédn y comunicaciodn (sitio web, correo electrdnico, call  center y otros), las Compafias deberan informar alos asegurados el alcance de la nueva ley, la forma  en la cual se puede solicitar el anticipo del pago de sus rentas vitalicias, y el efecto que dicho adelanto tendra sobre el monto de su pension futura; asi como resolver las consultas de sus pensionados.  Considerando el alto numero de consultas y requerimientos que potencialmente enfrentaran las  Companias, estas deberan tomar las medidas necesarias para:  a) Capacitar al personal encargado de la atencidon del publico, respecto del contenido de la nueva ley, asi como la forma y el plazo de pago y en general, sobre la operatoria para acceder al anticipo.  b) Procurar el mas alto estandar de disponibilidad de su Sitio Web (Uptime) y la estabilidad de sus servicios en ese canal, reforzandolos para evitar su saturacion.  c) Optimizar la atenciédn en sus sucursales. En este sentido, las Compafias deberan tener en funcionamiento medios de atencion presenciales en concordancia con las medidas sanitarias vigentes.  Dependiendo de la demanda de los canales presenciales, deberan evaluar medidas que les permitan descongestionar sus sucursales y atender adecuadamente a los pensionados. Las Companias, actuando en conjunto, podran implementar locales de atencién presencial en distintos lugares del pais, con el objetivo de facilitar a los asegurados el tramite de anticipo de rentas vitalicias, adoptando las medidas requeridas por las autoridades sanitarias y de seguridad publica. Lelie el , , ee , ; rere = Para validar ir a http://www.svs.cl/institucional/validar/validar. php 2 Spas FOLIO: RES-2340-21-21272-A erect Pagina 4/18  d) Reforzar sus canales de atencion. Con el objeto exclusivo de proporcionar atencidén a sus asegurados por motivo del anticipo a que se refiere la nueva ley, las Companias podran contratar servicios telefonicos, apoyos externos, personal para responder consultas web y para la atencion de sucursales. En este sentido, se deberan tomar todas las medidas de seguridad que garanticen la confidencialidad de la informacion a que tengan acceso.  Asi también, las Companias pueden implementar en forma conjunta sitios web comunes, con el objetivo de facilitar a los asegurados la solicitud de anticipo de rentas vitalicias resguardando la seguridad de la informacion.  Por otra parte, se autoriza a las Aseguradoras para informar a los pensionados y beneficiarios que la solicitud de anticipo durante los primeros 10 dias habiles contados desde el lunes 3 de mayo de 2021, se debera efectuar de manera remota. Lo anterior, sin perjuicio que se deberan recibir las solicitudes que se presenten de manera presencial a partir de dicha fecha.  e) Implementar en todos sus canales de atenciOn, presenciales y remotos, metodologias para la administracion eficiente de filas de espera.  f) Ejecutar todas las acciones tendientes a optimizar el servicio a sus asegurados, de manera tal que estos puedan tramitar sus solicitudes y efectuar sus consultas y reclamos, preferentemente a traves de sus canales remotos.  Asimismo, deberan efectuar campanas de informacion a traves de medios de comunicacion masivos donde deberan abordar el procedimiento para el anticipo y el pago del mismo, enfatizando que los pensionados privilegien los canales remotos para realizar la solicitud, informando que el anticipo de rentas vitalicias se puede efectuar durante los 365 dias siguientes a la publicaci6n de la nueva Ley en el Diario Oficial. Estas campanas podran realizarse conjuntamente entre todas las companias, un grupo de ellas o a traves de su Asociacion Gremial.  Por otra parte, a contar de la fecha del presente Oficio y dentro de los siguientes 10 dias, las  Aseguradoras deberan enviar informacion a los pensionados y beneficiarios, preferentemente por  medios electrdnicos, sobre el procedimiento de solicitud del anticipo.  Adicionalmente, debera informarse a los pensionados que en el sitio web que implementen las  Aseguradoras podran acceder a informacion acerca del impacto, en términos generales, del anticipo  en su pension.  Lelie el , , ee , ; rere = Para validar ir a http://www.svs.cl/institucional/validar/validar. php 3 Spas FOLIO: RES-2340-21-21272-A erect Pagina 5/18  2. Derecho a anticipo De acuerdo a lo establecido en la Ley, ”/os pensionados o sus beneficiarios por renta vitalicia podran, por una sola vez y de forma voluntaria, adelantar el pago de sus rentas vitalicias hasta por un monto equivalente al diez por ciento del valor correspondiente a la reserva técnica que mantenga el pensionado en Ia respectiva compafnia de seguros para cubrir el pago de sus pensiones, con un tope maximo de ciento cincuenta unidades de fomento”. Por lo tanto, quien puede solicitar un anticipo es el pensionado (sea de renta vitalicia inmediata o diferida) o sus beneficiarios que tienen derecho a una renta vitalicia, considerando para tal efecto, la reserva técnica calculada para ese pensionado o beneficiario. Se precisa para estos efectos que por beneficiarios se entenderan aquellos que ya han accedido al pago de la renta vitalicia. En caso de poseer mas de una pension, el anticipo se debera tramitar en forma separada para cada una de ellas. 3. Implementacion de aplicacion para el anticipo de rentas vitalicias A mas tardar el dia lunes 3 de mayo, a las 9:00 a.m., las Aseguradoras deberan tener habilitado en la pagina principal o de inicio de su sitio web publico un acceso que conduzca directamente a una aplicacion informatica para el ingreso de la solicitud del anticipo. El acceso directo senhalado anteriormente podra ser desarrollado de manera individual por cada Compania o podra ser compartido entre todas ellas. El sitio debera contener al menos lo siguiente: a) El texto de la nueva Ley. b) Un amplio set de preguntas y respuestas asociadas a la solicitud y pago del anticipo, en un lenguaje claro que facilite su comprension. c) El formulario o aplicacidn que permita el ingreso de la informacion necesaria para tramitar la solicitud de acuerdo con el numero 4 siguiente. 4. Solicitud de anticipo El proceso de solicitud de anticipo debera contemplar los siguientes elementos y caracteristicas: e El formato de la solicitud debera requerir al menos la siguiente informacion: nombre completo, numero de cédula de identidad y su serie o numero de documento, domicilio completo, telefono y correo electronico, ademas de las respectivas instrucciones de llenado. Lelie el , , ee , , rere = Para validar ir a http://www.svs.cl/institucional/validar/validar. php 4 Spas FOLIO: RES-2340-21-21272-A ler tee Pagina 6/18  e En la misma solicitud se debera informar que el anticipo se pagara por la misma via que regularmente se paga la pension.  e El primer dato a requerir para el llenado de la solicitud, debe ser el numero de cédula de identidad del pensionado, con el cual la Aseguradora debera verificar la calidad de asegurado a la Compania, no permitiendo continuar el tramite de no validarse correctamente dicha calidad.  e Debera consultarse al asegurado si es deudor de pension de alimentos, con opcidn de responder si o no. La respuesta a esta consulta es obligatoria y el sistema debera requerir al solicitante ratificar su respuesta.  e Atendido lo dispuesto en el articulo 38 bis de la Constitucion Politica de la Republica, la aplicacion debera contemplarse una consulta mediante la cual el solicitante declare si es o no autoridad publica de las senaladas en dicha norma.  e En el caso de beneficiarios que solicitan el anticipo de fondos, se debera consultar el RUT del apoderado que se encuentre cobrando la pension de sobrevivencia, en el caso que el beneficiario respecto del cual se solicita el anticipo sea menor de 18 anos.  e Por otra parte, en el caso de solicitantes con cédula de identidad bloqueada o vencida mas alla del plazo establecido por los Decretos Supremos N° 32 y N° 34, de 2020, del Ministerio de Justicia y Derechos Humanos, o de aquellos que los modifiquen o reemplacen, las Aseguradoras deberan implementar mecanismos de autenticacion que permitan verificar la identidad del solicitante.  e Las Companias deberan extremar las medidas de control de validacion de las solicitudes que se ingresen, de tal forma de mitigar la ocurrencia de fraudes.  e La solicitud debe requerir una doble digitacidn de la serie o numero de documento de la cédula de identidad, direccidn de correo electronico, numero de teléfono. En el caso de la serie o numero de documento de la cédula de identidad solo se debe permitir el ingreso de letras mayusculas. Debera validar asimismo que los campos de correo electronico y telefono cumplan con la estructura de éstos.  e La Aseguradora debera notificar al pensionado que ha recibido la solicitud de anticipo, enviando la notificacion al correo electronico y celular que estén registrados previamente en la base de datos, ademas de los informados en la respectiva solicitud. También, debera implementar mecanismos de monitoreo de cambios de datos de contacto en las bases de datos, que le permita contar con sistemas de alerta temprana de fraudes.  Lelie el , , ee , ; rere = Para validar ir a http://www.svs.cl/institucional/validar/validar. php 5 ie kes FOLIO: RES-2340-21-21272-A Dac Pagina 7/18  e Las solicitudes presenciales, incluyendo aquellas por mandato, se sujetaran a las mismas validaciones que aquéllas presentadas a través del sitio web de las Aseguradoras. 5. Informacion al Solicitante En un plazo maximo de cuatro dias habiles siguientes a la recepcion de la solicitud, las Aseguradoras deberan validarla y comunicar a los pensionados, subrogantes o beneficiarios, si la solicitud fue aceptada o ésta se rechazo, indicando en este ultimo caso, con detalle, las razones de ello, evitando mensajes generales que no permitan al solicitante conocer con exactitud la informacion a corregir. En la comunicacion informando el rechazo se debera indicar que se debera realizar una nueva solicitud y que, consecuentemente, el plazo para el pago del anticipo se contara desde la fecha de la nueva solicitud. Las Aseguradoras deberan remitir a los pensionados y beneficiarios, en su caso, Una Comunicacion al correo electronico o celular que posea la Compania, que estén registrados previamente en la base de datos, ademas del correo electronico o celular registrado en la respectiva solicitud. En caso de solicitudes que la Aseguradora pueda calificar de mayor riesgo, debera adoptar medidas adicionales de validacion de la solicitud y de la identidad del solicitante. Al respecto, en la sefnalada comunicacion se debera informar el monto del anticipo a solicitar, expresado en UF y pesos, senalando que el valor en pesos es referencial a la fecha de la comunicacion y podria sufrir variaciones de acuerdo a las fluctuaciones que experimente el valor de la UF. Para facilitar la decisi6n de confirmacion, esta comunicacidn debera contener informacion individualizada donde se senale las opciones de porcentajes de anticipo y la pension resultante producto de éstos, segun la tabla adjunta: 0% a ee es pH po mm pm pm a <n po 8H pm pm mete §— Para validar ira http:// Vinstitucional/validar/validar ph See ara validar ir a http://www.svs.cl/institucional/validar/validar.pnp 6 Ps FOLIO: RES-2340-21-21272-A Pagina 8/18  Se deberan presentar ademas el siguiente mensaje: “Su anticipo se imputard al monto mensual de sus rentas vitalicias futuras, de modo que sus pensiones futuras se veran reducidas, al rebajarse proporcionalmente de ellas, el monto anticipado.“ Adicionalmente, el asegurado debera ser informado sobre la modalidad de pago y sobre el plazo que establece la ley para que dicho pago se materialice. Por ultimo, la Compania le debera indicar claramente al asegurado, la forma y el plazo limite para confirmar el anticipo solicitado, el cual no podra ser inferior a 10 dias corridos desde que recibe la presente comunicacion. Si el solicitante, no envia la confirmacion dentro del plazo senalado, debera ingresar una nueva solicitud conforme a lo establecido en el numeral 4 del presente instructivo. 6. Confirmacion del anticipo Una vez proporcionada la informacion del punto 5 anterior, el sistema debera permitir al solicitante, seleccionar el porcentaje (1 a 10% sin decimales) que desea adelantar de su pension. De seleccionarse un anticipo inferior al maximo permitido, debera desplegarse una nota que indique que el pensionado o beneficiario, no podra efectuar en el futuro un nuevo anticipo por el porcentaje remanente, ademas de requerirle ratificar que esta seguro que desea retirar un monto menor que el maximo permitido por la ley. La aplicacion debera entregar un comprobante al pensionado donde conste al menos la fecha de la confirmacion, la opcidn seleccionada por anticipo total o parcial y en este ultimo caso, el porcentaje solicitado respecto del maximo permitido y un numero de identificacion de la solicitud. Asi también, la Aseguradora debera comunicar al solicitante el medio y la fecha en que se cursara el pago. En esta misma comunicacion, la compajnia le indicara al asegurado, que, pagado el anticipo, se entiende aceptado el endoso de la poliza, en los terminos del anticipo. Las Companias deberan informar a las instituciones pagadoras el numero de cuenta para la generacion del mecanismo de intangibilidad que establece la Ley. En el caso que el pago se efectue en el mismo dia del pago regular de la pension, se debera especificar claramente la parte del pago que corresponde al anticipo del 10%. 7. Solicitudes presenciales Los asegurados también podran requerir el anticipo de fondos de manera presencial, previa presentacion de su cédula de identidad. Las Aseguradoras podran establecer un criterio para la atencidn de los pensionados por dia (edad, numero de RUT, letra del nombre, etc.), que permita cumplir las medidas y recomendaciones Lelie el , , ee , , rere = Para validar ir a http://www.svs.cl/institucional/validar/validar. php 7 ie kes FOLIO: RES-2340-21-21272-A eee ae Pagina 9/18  Sanitarias vigentes en las sucursales. Dicho criterio debera ser comunicado en forma anticipada a los pensionados directamente y a través del sitio web de la compajiia. 8. Pensiones de alimentos Las retenciones judiciales por pago de deudas alimenticias y las solicitudes de anticipo con subrogacion del asegurado decretado en un juicio de alimentos, se regiran por lo dispuesto en la Ley como asimismo en las resoluciones emanadas del Poder Judicial, conforme sus potestades establecidas en la Constitucion Politica de la Republica. En todo caso, las deudas originadas por obligaciones alimentarias deberan pagarse por la Compania, a quien haya dispuesto el tribunal respectivo y por los medios que este haya ordenado (ya sea transferencias electronicas, retencion, vale vista, cheque, etc.), para lo cual debera recabar los antecedentes que sean pertinentes. 9. Solicitudes de anticipo por mandato La solicitud de anticipo de recursos podra realizarse también a través de mandatario. Para tal efecto, los asegurados deberan otorgar los mandatos mediante escritura publica o instrumento privado firmado en presencia de notario publico, u Oficial del Registro Civil en los lugares donde no hubiese Notaria. Asimismo, se autorizan mandatos con firma electronica avanzada, de acuerdo a la ley N° 19.799, con los debidos resguardos para evitar la ocurrencia de fraudes. El mandato debera indicar, ademas de las menciones propias de este tipo de instrumentos, el nombre de la compania pagadora de la renta vitalicia, la declaracion del mandante que conoce que su anticipo “se imputardad al monto mensual de sus rentas vitalicias futuras “, de modo que sus pensiones futuras, se veran reducidas, al rebajarse proporcionalmente de ellas, el monto anticipado. La solicitud de anticipo a través de mandatario, no altera la forma de pago indicada en estas instrucciones, de modo que el pago debera realizarse en la misma forma que regularmente se pagan las pensiones, acorde a las instrucciones del numero 4 anterior. En todo caso, la forma en que se realizara el tramite a través de mandatario debera ser definida por cada Compania en funcion de los riesgos que puedan estar involucrados en este proceso. 10. Solicitudes por servicio telefonico (call center) Las Companias podran implementar procedimientos para la recepcion de solicitudes de anticipo a traves de servicio telefonico, las que se sujetaran a las mismas instrucciones que las solicitudes efectuadas a partir del sitio web, en particular, lo relativo a la informaci6n a proporcionar al Lelie el , , ee , ; rere = Para validar ir a http://www.svs.cl/institucional/validar/validar. php 3} Spas FOLIO: RES-2340-21-21272-A erect Pagina 10/18  solicitante para una adecuada comprension de este proceso y de las variables fundamentales para su Solicitud de anticipo. En este caso, las atenciones deberan ser grabadas, informando de ello al pensionado o beneficiario y estar disponibles para la fiscalizaci6n de esta Comision. Las Companias deberan implementar todas las medidas de validacion que sean pertinentes para acreditar la identidad del solicitante. 11. Correccion de errores en las solicitudes presentadas El sistema debera contemplar mecanismos para corregir, retirar y presentar nuevamente solicitudes de anticipo, en tanto no se haya cursado el pago. En el caso de rechazos de solicitudes de anticipo derivadas de validaciones efectuadas con o por las instituciones financieras, se debera comunicar clara, detallada y oportunamente la informacion a los pensionados y beneficiarios sobre el impedimento, ya sea via correo electronico, telefono u otro, con el objeto que aquellos puedan efectuar las correcciones pertinentes o soliciten un medio de pago alternativo. 12. Pago del anticipo La nueva ley establece la entrega de los fondos solicitados en un solo pago dentro de treinta dias corridos desde la fecha de la solicitud. Para los efectos de asegurar un ordenado y continuo pago de las solicitudes de anticipo, las Companias deberan planificar adecuadamente sus fechas de pago, efectuando las necesarias coordinaciones con los bancos y otras instituciones pagadoras, cuando corresponda, evitando en la medida de lo posible, concentracion de altos montos de pagos en un dia o en unos pocos dias. Asi también, las companfiias deberan evaluar las distintas fuentes de financiamiento que tienen a su disposicion para generar la liquidez necesaria con el objetivo de cumplir con las solicitudes de anticipo de los pensionados, asociadas a esta Ley. El hecho de mantener los canales de pago regulares que utilizan los pensionados para este proceso, evidentemente no obsta para que las Compafias tramiten expeditamente las solitudes de cambio de modalidad de pago que pudieran facilitar el proceso de pago del anticipo de pensiones. Si la Aseguradora toma conocimiento del fallecimiento de un pensionado o beneficiario, encontrandose a esa fecha pendiente el pago del anticipo, debera suspender el pago. Por otra parte, en aquellos casos donde el solicitante haya declarado que es deudor de pensiones alimenticias en el formulario de solicitud, las Aseguradoras no podran efectuar el pago del anticipo Lelie el , , ee , , rere = Para validar ir a http://www.svs.cl/institucional/validar/validar. php 9 Spas FOLIO: RES-2340-21-21272-A erect Pagina 11/18  solicitado. La Aseguradora solo podra efectuar el pago si el pensionado o beneficiario rectifica que no es deudor de alimentos mediante la suscripcidn de una declaracion jurada y aquella no ha recibido una notificacion del poder judicial senalando la existencia de una deuda de alimentos. En todo caso, las deudas originadas por obligaciones alimentarias deberan pagarse por la compania, a quien haya dispuesto el tribunal respectivo y por los medios que este haya ordenado (ya sea transferencias electrdnicas, retencidn, vale vista, cheque, etc.), para lo cual, deberan recabar los antecedentes que sean pertinentes. 13. Retractacion de la solicitud El derecho a anticipo es renunciable. Considerando lo anterior, aquellos pensionados que hayan presentado una solicitud de anticipo de rentas vitalicias podran retractarse de su solicitud, lo cual deberan comunicarlo a la Aseguradora a mas tardar el dia anterior a la fecha de pago del monto solicitado retirar. El procedimiento establecido por las Aseguradoras para la retractaciOn de la solicitud, debe ser expedito y asegurar que quien efectua el retracto sea efectivamente el pensionado, beneficiario o el mandatario que presento la solicitud. Acreditado lo anterior, las Aseguradoras deberan anular la solicitud de anticipo, sin mas tramite. Ademas, la opcion de retracto de la solicitud debe estar disponible a través de los mismos canales por los cuales se estan recibiendo solicitudes. Por otra parte, el procedimiento de retracto debera constar en la seccion de preguntas y respuestas, a que se refiere la letra b) del numero 3. del presente Oficio. En esta se debe explicar en forma clara y sencilla, como el pensionado o beneficiario puede efectuar su derecho a retractacion y el plazo que tiene para ello. Lo anterior no obsta a que el pensionado o beneficiario pueda presentar una nueva solicitud de anticipo, siempre que lo haga dentro del plazo de los 365 dias siguientes a la publicacio6n de la Ley en el Diario Oficial. 14. Procedimiento de denuncias Para aquellos casos de pensionados que, habiendo recibido la comunicacion de la recepcion de su solicitud de anticipo, o de aceptacion y/o rechazo de ella, manifiesten desconocer haber realizado la solicitud de anticipo, las Aseguradoras deberan establecer un procedimiento expedito para recibir y procesar tales denuncias y para proceder a detener el cargo en la respectiva cuenta. En materia de gestion de reclamos, las Aseguradoras deberan registrar todos los reclamos asociados a los anticipos autorizados en virtud de la nueva ley, cualquiera sea el canal de ingreso, asignandole tickets que permitan a los pensionados y beneficiarios hacer el seguimiento de sus casos. Lelie el , , ee , ; rere = Para validar ir a http://www.svs.cl/institucional/validar/validar. php 10 ie kes FOLIO: RES-2340-21-21272-A eee ae Pagina 12/18  Adicionalmente, las Aseguradoras deben informar proactivamente a los pensionados y beneficiarios acerca del avance de sus reclamos. Al mismo tiempo, deberan establecer un canal formal de escalamiento para derivar casos que ingresen a la CMF, designando una contraparte especialmente dedicada en la Aseguradora para atender estos casos. 15. Otras consideraciones Las Aseguradoras deberan informar a través de sus diferentes canales de atencio6n y comunicacion, de forma clara, precisa y destacada, el procedimiento detallado que deberan seguir los pensionados y beneficiarios para efectuar su anticipo desde el extranjero y cOmo resolver sus dudas, siendo responsabilidad de la Aseguradora la atencion expedita de todos los pensionados y beneficiarios en esta situacion. Asimismo, deberan proveer canales de comunicaciOn para que los pensionados residentes en el extranjero puedan contactar con facilidad a la Aseguradora, ya sea via correo electronico, telefono, chat u otro, de modo tal de poder resolver las situaciones que les aquejan. Lo antes indicado, debera constar en el set de preguntas y respuestas que las Aseguradoras deberan disponer en sus sitios web, de acuerdo a lo sefalado en la letra b) del numero 3. anterior. Las Aseguradoras a través de sus distintos canales de atenci6n deberan disponer de informacion para los pensionados y beneficiarios respecto del estado de su solicitud de anticipo, informando de forma clara y precisa sobre las distintas etapas y situaciones del proceso (recepcidn de la solicitud, validaci6n, aceptacion-rechazo, causas del rechazo, medidas cautelares y pago), asi como respecto del estado de los reclamos que puedan presentarse. Las instrucciones del presente numeral deberan estar operativas a partir del lunes 3 de mayo de 2021.  Lelie el , , ee , ;  rere = Para validar ir a http://www.svs.cl/institucional/validar/validar. php 11  Spas FOLIO: RES-2340-21-21272-A  erect  Pagina 13/18  Il. Instrucciones en materia de estimacion del monto maximo del anticipo y afectacion del monto de pension y reservas técnicas  1. Estimacion del monto maximo del anticipo Las companias deberan estimar el monto maximo a retirar por los rentistas considerando la reserva técnica que mantenga con éste. La reserva a considerar, en consistencia con la Circular N° 2.062, sera la reserva técnica base. Esta reserva sera la constituida al cierre mensual inmediatamente anterior a la fecha de solicitud del anticipo, a la cual deberan descontarse las pensiones pagadas entre el cierre y la fecha de la solicitud, y sin considerar los flujos asociados a la cuota mortuoria. En funcion de los parrafos precedentes, el monto maximo de anticipo por cada rentista estara dado por el 10% de esta reserva, con un tope maximo de UF150. 2. Ajuste de pension De acuerdo a la nueva Ley, el anticipo que efectuen los pensionados o sus beneficiarios que opten por solicitarlo, se imputara al monto mensual de sus rentas vitalicias futuras, a prorrata, en forma proporcional y en igual porcentaje que aquel que represente el monto efectivamente retirado. Por lo anterior, el nuevo monto de pension se estimara aplicando el porcentaje del anticipo solicitado sobre la reserva mantenida por la compania con el rentista, de acuerdo a lo indicado en el punto anterior, a la pension vigente definida en la poliza al cierre inmediatamente anterior. De esta manera, si el anticipo es de un 10% de la reserva, indicada en el punto 1, la pension del solicitante caera en un 10%. 3. Estimacion de reservas técnicas posterior al anticipo Las companias, una vez efectuado el anticipo, deberan reestimar las reservas técnicas asociadas a dicha poliza en funcion del nuevo monto de pension estimada de acuerdo a lo senalado en el punto 2. anterior, aplicando la normativa vigente establecida para estos efectos y considerando los procesos de reconocimiento gradual de las tablas de mortalidad. En el caso de aquellas companias que mantengan un proceso de reconocimiento de las tablas de mortalidad 2006 en funcion de una cuota fija, la reestimacion de ésta se debera realizar en consideracion a las fechas establecidas en la Circular N° 1.857 y sus modificaciones.  Lelie el , , ee , ;  rere = Para validar ir a http://www.svs.cl/institucional/validar/validar. php 12  ie kes FOLIO: RES-2340-21-21272-A  Dac  Pagina 14/18  lll. Estadisticas a transmitir a la Comision para el Mercado Financiero Adjunto al presente Oficio se remiten los archivos de solicitudes y pagos de anticipo de rentas vitalicias. A contar del lunes 3 de mayo, las Companias de Seguros deberan enviar diariamente a esta Comision, incluido los dias sabados y domingos, un archivo agregado con la cantidad de solicitudes recibidas cada dia y las acumuladas a la fecha, con corte a las 17:00 horas del dia. La informacion debera ser enviada de acuerdo al archivo Excel que se adjunta al presente Oficio, mediante el sistema SEIL habilitado en la pagina web del Servicio, cada dia a mas tardar a las 18:00 horas. Adicionalmente, la informacion con el detalle asociado a las solicitudes realizadas debera ser transmitida a esta Comision, mediante el sistema SEIL habilitado en la pagina web del Servicio, desde el lunes 10 de mayo proximo. La frecuencia de transmision sera semanal, los dias lunes, incluyendo festivos, a mas tardar a las 12:00pm con la informacion al cierre del viernes anterior a las 17:00. Se adjuntan los archivos con el detalle de los campos a reportar y con el formato requerido por la CMF. JOAQUIN CORTEZ HUERTA PRESIDENTE COMISION PARA EL MERCADO FINANCIERO cinta - Para validar ir a http://www.svs.cl/institucional/validar/validar. php 13 sees FOLIO: RES-2340-21-21272-A eee ae Pagina 15/18  03-05-2021 04-05-2021 05-05-2021 06-05-2021 07-05-2021) os-os-2024f 0 EN CADA CASILLERO: ACUMULADO AL DiA Y FECHA DE CORTE TOTAL RUT UNICOS Cantidad de solicitantes que han ingresado una solicitud independiente de cuantas solicitudes han ingresado Count( Distinct RUT) TOTAL SOLICITUDES Cantidad de solicitudes ingresadas, independiente de si hay solicitantes repetidos Count (Folio de solicitud) TOTAL RECHAZOS Cantidad de solicitudes rechazadas por la compafiia de seguros Count(Folio de solicitud) where estado=rechazada TOTAL PAGOS NUMERO DE PAGOS ACUMULADOS ALA FECHA Y HORA TOTAL MONTO PAGADO MONTO PAGADO EN S$ ACUMULADO A LA FECHA Y HORA RETENCIONES JUDICIALES CANTIDAD DE RUT CON RETENCIONES JUDICIALES N° RUT UNICOS QUE SUSCRIBIERON y QUE CUMPLEN CANTIDAD DE SOLICITANTES QUE CONFIRMARON LA SOLICITUD DE RETIRO LOS 10 DIAS HABILES % PAGADO A LA FECHA, RESPECTO RUT QUE % PAGADO A LA FECHA, RESPECTO DEL TOTAL DE SOLICITANTES QUE CONFIRMARON LA SOLICITUD DE RETIRO SUSCRIBIERON Y QUE CUMPLEN 10 DIAS HABILES Lelie el , , ee ; , raritee = Para validar ir a http://www.svs.cl/institucional/validar/validar. php gras FOLIO: RES-2340-21-21272-A Pagina 16/18  Solicitudes retiro % de la reserva técnica de renta vitalicia por Ley 21.330 Archivo: RUTCIA_retiroRV_aaaammdd.txt Donde RUTCIA corresponde al Rut de la compaiiia sin digito verificador, aaaa corresponde al afio, mm mes y dd dia del envio del archivo | folio mt Corresponde al nvimero de solicitud. Debe ser un identificador unico | RUTNUmero 8) CorrespondealRuTdelsolicitante RUT DV 8 Corresponde al digito verificadordelsolicitante Feodesoutte | 88 iircentcarccecerstndescvemence | | 02: Beneficiario de pension de sobrevivencia 01: Desde Chile, de manera presencial 02: Desde Chile, a través de internet Canal a través del cual realiza solicitud 9(02) 03: Desde Chile, otros medios , . 04: Desde el extranjero, a través de internet 05: Desde el extranjero, a través del consulado 06: Desde el extranjero, otros medios T: En proceso de validacion R: Rechazada Campo dinamico por lo que puede ser modificado en el tiempo segun como Estado de la solicitud X(01) A: Aprobada 7 . - _ cambie el estado de la solicitud. D: Desistida P: Pagada 01: Sin retencién Clasificacién de solicitud 9(02) 02: Retenida por autodeclaracion. Campo dinamico por lo que puede ser modificado en el tiempo segun si el 03: Retenida por CAPJ (Corporacién Adm. Poder Judicial) pensionado tiene alguna medida cautelar por deuda alimentaria. 04: Retenida por oficio tribunal Corresponde a la fecha del resultado del proceso validaci6n de la solicitud (Aprobada o Rechazada). Se informa una fecha valida cuando el estado de la solicitud es aprobada o rechazada. Si la solicitud esta en proceso de Fecha de validacion de solicitud 9(08) aaaammdd validacion sin un resultado de aprobada o rechazada, este campo se informa con ceros. La fecha de validacion debe ser igual o posterior a la fecha de ingreso de la solicitud y debe ser anterior ala fecha de pago. 01: Problemas con cuenta bancaria y/o Instituci6n Financiera para el sb cetuls de identidad no validada o no vigente segtin Servicio El codigo 01 hace referencia a cuentas no validadas, cuentas bloqueadas, Motivos del rechazo 9(02) 03: No acredita condicién de beneficiario de pensidn de 10 casos rechazados por el banco. . . . sobrevivencia Las solicitudes que no debiesen haber ingresado (solicitudes repetidas, entre otras) no deberan ser reportadas en este archivo. 04: Otros 99: No rechazado prominame, ate aetna pomnwns fom ff forint Corresponde al porcentaje que representa el monto solicitado respecto de la Porcentaje de monto solicitado respecto de la reserva técnica 9(02) 13 reserva técnica a la fecha de solicitud. Se debe informar con valores entre 1 y 10. a [MontodelareservatécnicaS | ty 5 [CorrespondealmontoenSalafechadelasolicitud. Corresponde a la fecha en la cual queda disponible el pago para el pensionado en el medio pago seleccionado. En caso de que el pago se realice Fecha de pago 9(08) aaaammdd 16 a un banco extranjero correspondera a la fecha en que se envio la némina al banco. La fecha de pago debe ser igual o posterior a la fecha del cargo. Si el campo Clasificacion de solicitud tiene codigos 02, 03 0 04, este campo debe informarse en 0. eee em De freemen [MontopagoenS sy 8 CorrespondealmontoenSalafechadepago. 01: Efectivo 02: Cuenta RUT 03: Cuenta Corriente 04: Cuenta Vista bancaria Medio de pago 9(02) 05: Cuenta Vista en Cooperativa 19 06: Cuenta de Ahorro bancaria 07: Vale vista 08: Cuenta bancaria en el extranjero 09: Otro 01: BANCO ESTADO 02: BCI 03: BANCO BICE 04: BANCO CONSORCIO 05: CORPBANCA 06: BANCO DE CHILE-EDWARD-CREDICHILE 07: BANCO DEL DESARROLLO 08: BANCO FALABELLA 09: BANCO INTERNACIONAL 10: BANCO ITAU-CORPBANCA 11: BANCO PARIS Institucion financiera para la transferencia 9(02) 12: BANCO RIPLEY 20 13: BANCO SANTANDER 14: BANCO SECURITY 15: COOPEUCH 16: HSBC (CHILE) 17: SCOTIABANK CHILE 18: SCOTIABANK AZUL (ex BBVA) 19: CAJA DE COMPENSACION LOS HEROES 20: Banco en el extranjero 88: Otros Bancos 89: Otras Instituciones para pago en efectivo 99: No corresponde informar Lelie el , ; ee ; ; rariteea = Para validar ir a http://www.svs.cl/institucional/validar/validar. php an. fore areteas = FOLIO: RES-2340-21-21272-A eee ae Pagina 17/18  Cautelares y Liquidaciones tercer retiro 10% de los fondos de capitalizacion individual por Ley 21.330 Archivo: RUTCIA_CAUT_retiroRV_aaaammdd.txt Donde RUTCIA corresponde al Rut de la compaiiia sin digito verificador, aaaa corresponde al afio, mm mes y dd dia del envio del archivo | met foremntanneneiietncnrntenatena Rutdeudor ———C—SC OBB Rutdeldeudor [Dvdeudor CSCS 8 igito Verificadordeldeudor CCCid Rutalimentario TT C—~sC OBJ Rutdelalimentario Cd [Dvalimentario CSCS) FOS Digit Verificadordelalimentario Cd [Corcausa————CS (HY Correlativocausanico Cid 2) 7 Ntimero Del Rol intemodeTribunales [Cod Tribunal —C—SC—S COS) 8 edigotribunal Pecan my anna tancn HME orate et teats compare oie retencion V: CIA valida afiliacion Estado_Registro X(01) |D: CiA devuelve rechazado afiliacién y/o beneficiario 11 Estado del registro informado S: CIA valida beneficiario de pension por sobrevivencia N=NO pensionado autodeclar6 en formulario de solicitud de retiro tener deuda Auto_Dec X(03) . . . 13 a. . N/A=no aplica, no fue consultado en el formulario de solicitud de por pension alimenticia retiro . S=SI - , . 7 medida cautelar S=Sl Estado_Pago X(01) |N=NO; se debe considerar como S también, si ya fue instruido ala 17 Estado de pago en COMPANIA, si se pago o no el retiro 10% institucidn financiera y no se pudo retener el pago. ecm Page temanente-sLsensomdo | tm) [aataimo> | eteattoraclpensinado listo nn AS Fecha_Pago_Remanente_al_pensionado 9(08) |AAAAMMDD 21 : . retiro a favor del pensionado (deudor) C:CAPJ Tipo_remision X(01) | T: Directo Oficio Tribunal 22 Tipo de envio de la medida cautelar por el Tribunal a la COMPANIA. A: AutoDeclaracion, solo sino hay C6 T dicha causa pe nee Estado_Revoca X(01) |N=NO 24 causa S=Sl Recepcién_Liquidacion X(01) |N=NO 25 Recepcion de Liquidacién para la medida cautelar de retencion N=No Pagada 01. Sin solicitud de Retiro (por el pensionado o Subrogacidn) 02. Solicitud de Retiro en Estado Rechazada. 03. Solicitud de Retiro en Estado Ingresada. 04. Deudor tiene un numero mayor de medidas cautelares notificadas que Resoluciones de pago recibidas. 05. RIT de medidas cautelares no coinciden con causas de Resoluciones de pago. 06. Monto Retiro agotado. 07. Monto Retiro disponible, no alcanza para cubrir las deudas de pension alimenticia SI el campo Estado_Liquidacidn se informa como N (No Pagada), se Motivo_No_Pago_Liquidacion 9(02) 08. Diferencias entre lo notificado por Previred y lo notificado 27 oo. — ’ . 7 . deben indicar el motivo. directamente a la compafiia por tribunales. 09. Medida cautelar notificada con posterioridad a la solicitud y pago del retiro. 10. Liquidacidn de pago asociada a otros retiros (Leyes N°21.248 y N°21.295). 11. Recepcidn de liquidacién, sin cautelar previa. 12. Recepcidn de liquidaciones duplicadas. 13. Pendientes de respuesta por parte del Poder Judicial. 14. Depdsito en proceso. 15. Otro Lelie el , ; ree . . rar es Para validar ir a http://www.svs.cl/institucional/validar/validar.php 2 i coe Race FOLIO: RES-2340-21-21272-A Pagina 18/18"
text_2 = "REF. DA CURSO A ANOTACION EN EL  REGISTRO ESPECIAL DE ENTIDADES  INFORMANTES.  SANTIAGO, 05 de abril de 2021  RESOLUCION EXENTA N°? 1924  VISTOS:  Lo dispuesto en los articulos 3°, 5° y 20 N° 13 del D.L. N° 3.538 de 1980 que crea la Comision para el Mercado Financiero; en el articulo 7 de la Ley N° 18.045 de Mercado de Valores; en los articulos 84 y 90 del articulo primero de la Ley N° 20.712, el cual aprueba ley que regula la administraci6n de fondos de terceros y carteras individuales; en el nimero 2.1 de la Norma de Caracter General N° 364 y en la Resoluci6n Exenta N°1261 de 2021.  CONSIDERANDO:  1. Que, la sociedad Administradora Roccas S.A. se encuentra inscrita en el Registro Especial de Entidades Informantes, bajo el numero 322 de fecha 09 de abril de 2015.  2. Que, la sociedad Administradora Roccas S.A., mediante presentacién de 10 de noviembre de 2020, inform6 que:  solicitamos a Ud. cancelar la inscripci6n de la sociedad Administradora Roccas S.A. y del Fondo de Inversién Privado Roccas Retail del Registro Especial de Entidades Informantes, por haberse acordado su disolucion’’.  3. Que, de acuerdo a los antecedentes que obran en poder de esta Comision, habiéndose disuelto la sociedad en conformidad a lo dispuesto en el articulo 103 numero 3 de la Ley N° 18.046 sobre Sociedades Anonimas, a esta fecha, no existen observaciones respecto de la anotacion de la disoluci6n de la sociedad en la inscripci6n senalada.  RESUELVO:  1. Dese curso a la solicitud de anotacion de la sociedad Administradora Roccas S.A. en el Registro Especial de Entidades Informantes, inscrita bajo el numero 322 de fecha 09 de abril de 2015, consistente en la disolucion de la sociedad, la cual se  es hee Para validar ir a http://www.svs.cl/institucional/validar/validar.php ee FOLIO: RES-1924-21-29355-R bec e:  realizara conforme a la informacion adjunta a la presente Resolucion.  2. Notifiquese la presente Resolucién a la Secretaria General de esta Comisi6n.  3. Una vez practicada la respectiva cancelacion, los oficios y antecedentes acompafnados a este Servicio por el interesado —que hasta este momento no tuvieren esa calidad- pasaran a ser publicos, correspondiendo al nivel O del clasificador de informacién actualmente vigente en la politica de manejo, clasificaciOn, tratamiento y resguardo de la informacion del Servicio, aprobado por Resolucién Exenta N°6605 de 2017.  DCFP/DCU (WF-1308135) Anotese, Comuniquese y Archivese. 7 W RCIA SCHILLI DIRECTO Lo PERVISION JOE CONDUCTA DE MERCADO A DEL SEJOFDE LA COMISION PAR MERGAQO FINANCTERO gra lal a, ae | , es mae = Para validar ir a http://www.svs.cl/institucional/validar/validar. php eee FOLIO: RES-1924-21-29355-R (a) ee Pagina 2/3  Contacto (noesparteregistro) isomer @roccasich Modificaciondelarazon social Modificacin delnombre defantasia | Liquidacion Division Fusion Cancelacion  mae = Para validar ir a http://www.svs.cl/institucional/validar/validar.php  FOLIO: RES-1924-21-29355-R  [eee oe  Pagina 3/3 "

'''
    LIMPIEZA DE PALABRAS
'''

def limpieza_text(text):
    # Eliminación de números
    text = re.sub("\d+", ' ', text)
    # Eliminación de espacios en blanco multiples
    text = re.sub("\\s+", ' ', text)
    # Eliminación de páginas web (palabras que empiezan por "http")
    text = re.sub('http\S+', ' ', text)
    # Eliminación de signos de puntuación
    regex = '[\\n°\\n\\!\\,\\"\\#\\$\\%\\&\\\'\\(\\)\\*\\+\\-\\\\/\\:\\;\\<\\=\\>\\?\\@\\[\\\\\\]\\^_\\`\\{\\|\\}\\~\\”\\“]'
    text = re.sub(regex, ' ', text)
    # Tokenizado y ignoracion de puntuación
    tokeniser = RegexpTokenizer(r'\w+')
    tokens = tokeniser.tokenize(text)
    print(tokens)

    # Normalización
    lemmatiser = WordNetLemmatizer()
    lemmas = [lemmatiser.lemmatize(token.lower(), pos='v') for token in tokens]

    # Stopwords
    keywords = [lemma for lemma in lemmas if lemma not in stopwords.words('spanish')]
    return keywords


doc_1 = limpieza_text(text_1)
doc_2 = limpieza_text(text_2)

'''
    BAG OF WORDS
'''
# Vectorizamos las palabras, separando por espacio
bagOfWordsA = doc_1.split(' ')
bagOfWordsB = doc_2.split(' ')

# Definir las palabras únicas
uniqueWords = set(bagOfWordsA).union(set(bagOfWordsB))
print(uniqueWords)

# Creación de diccionario para las palabras únicas.
# el diccionario se genera con las palabras de la data.

numOfWordsA = dict.fromkeys(uniqueWords, 0)
for word in bagOfWordsA:
    numOfWordsA[word] += 1

numOfWordsB = dict.fromkeys(uniqueWords, 0)
for word in bagOfWordsB:
    numOfWordsB[word] += 1

print(numOfWordsA)
print(numOfWordsB)


'''
    TERM FREQUENCY (TF)
'''
# Número total de veces que aparece una palabra en un texto, dividido por
# el total de palabras en el documento.
# Representa el valor de la celda en la matriz.

# obs: cada documento tiene su propia frecuencia.

def computeTF(wordDict, bagOfWords):
    tfDict = {}
    bagOfWordsCount = len(bagOfWords)
    for word, count in wordDict.items():
        tfDict[word] = count / float(bagOfWordsCount)
    return tfDict


# Intervalos inferiores para los datas
tfA = computeTF(numOfWordsA, bagOfWordsA)
tfB = computeTF(numOfWordsB, bagOfWordsB)

'''
    INVERSE DATA FRECUENCY (IDF)
'''
# IDF determina la relevancia de las palabras únicas en todos los documentos.

def computeIDF(documents):
    import math
    N = len(documents)

    idfDict = dict.fromkeys(documents[0].keys(), 0)
    for document in documents:
        for word, val in document.items():
            if val > 0:
                idfDict[word] += 1

    for word, val in idfDict.items():
        idfDict[word] = math.log(N / float(val))
    return idfDict

# IDF para todos los documento
idfs = computeIDF([numOfWordsA, numOfWordsB])


'''
    TF-IDF
'''
def computeTFIDF(tfBagOfWords, idfs):
    tfidf = {}
    for word, val in tfBagOfWords.items():
        tfidf[word] = val * idfs[word]
    return tfidf

# Aplicamos a Bases A y B
tfidfA = computeTFIDF(tfA, idfs)
tfidfB = computeTFIDF(tfB, idfs)

# Generación de matriz
df = pd.DataFrame([tfidfA, tfidfB])
print(df)


'''
    MODELO TF-IDF 'Suavizado'
(incluye todas las palabras sin stopwords)
'''

vectorizer = TfidfVectorizer()

vectors = vectorizer.fit_transform([doc_1, doc_2])

feature_names = vectorizer.get_feature_names()

dense = vectors.todense()

denselist = dense.tolist()

df = pd.DataFrame(denselist, columns=feature_names)
print(df)
